# K Means Clustering

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

iris = load_iris()
x = iris.data
scaler = StandardScaler()
x_scaled = scaler.fit_transform(x)

model = KMeans(n_clusters = 3, random_state=42)

model.fit(x_scaled)
labels = model.labels_
centroids = model.cluster_centers_

plt.figure(figsize=(10,8))
plt.scatter(x_scaled[:,0], x_scaled[:,1], s=50,c=labels, cmap='viridis')
plt.scatter(centroids[:,0], centroids[:,1], s=200, marker='x',c = 'red')
plt.title("K Means Clustering")
plt.show()

print("Cluster Centers:")
print(centroids)

y_true = iris.target
print("True labels:")
print(y_true[:50])

print("Predicted labels:")
print(labels[:50])